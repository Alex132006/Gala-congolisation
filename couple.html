<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mea+Culpa&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <title>Bielleterie-ouverte - Couple</title>
</head>

<style>
    * {
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
    }

    body {
        margin: 0;
        padding: 0;
        position: relative;
        min-height: 100vh;
        overflow-x: hidden;
    }

    body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url(image\ copy\ 3.png);
        background-size: cover;
        background-position: center;
        filter: blur(2px) brightness(0.8);
        z-index: -1;
    }

    /* Bouton info */
    .info-button {
        width: 50px;
        height: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 20px;
        border-radius: 30px;
        backdrop-filter: blur(100px);
        box-shadow: 0 0 10px #000000;
        color: #ffffff;
        border: 1px solid white;
        position: fixed;
        top: 10px;
        right: 10px;
        cursor: pointer;
        z-index: 1000;
        text-decoration: none;
    }

    .info-button:hover {
        transform: translateX(2px);
        background: rgba(255, 255, 255, 0.197);
        box-shadow: none;
    }

    /* Logos responsive */
    .logo {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 100px;
        height: auto;
        z-index: 999;
        border-radius: 50%;
        padding: 3px;
        mix-blend-mode: multiply;
        background: linear-gradient(to right, #ff000000, #ffffff00);
        z-index: 1000;
    }

    .logo2 {
        position: fixed;
        top: 20px;
        left: 20px;
        width: 100px;
        height: auto;
        z-index: 999;
        border-radius: 50%;
        padding: 3px;
        mix-blend-mode: multiply;
        background: linear-gradient(to right, #ffffff44, #ffffffac);
    }

    /* Section principale */
    .billet {
        text-align: center;
        padding: 20px;
        color: white;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 80vh;
        margin-bottom: 10vh;
    }

    .ligne {
        border-bottom: 1px solid #ff0000;
        padding-bottom: 10px;
        margin-bottom: 20px;
        width: 100%;
        max-width: 300px;
    }

    .billet h1 {
        font-family: "Mea Culpa", cursive;
        font-weight: bold;
        font-style: normal;
        font-size: clamp(40px, 10vw, 80px);
        margin-bottom: 20px;
    }

    .billet h3 {
        margin: 20px 0 10px;
        font-size: clamp(16px, 4vw, 20px);
        color: rgba(255, 255, 255, 0.9);
    }

    .user {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;
        z-index: 1;
        margin-top: 30px;
        width: 100%;
        max-width: 500px;
        padding: 0 20px;
    }

    .user-data {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;
        z-index: 1;
        margin-top: 30px;
        width: 100%;
        max-width: 500px;
        padding: 0 20px;
    }

    .users {
        background: #00000046;
        width: 100%;
        max-width: 300px;
        height: 40px;
        border-radius: 10px;
        border: 1px solid #ffffff;
        box-shadow: 0 0 10px #000000;
        color: #ffffff;
        font-size: 16px;
        text-align: center;
        padding: 0 15px;
    }

    .users::placeholder {
        color: rgba(255, 255, 255, 0.7);
    }

    .use-btn {
        margin-top: 20px;
    }

    .users-btn {
        width: 130px;
        height: 40px;
        background: #a4a2a25d;
        border-radius: 10px;
        border: 1px solid #f3f3f3;
        color: #ffffff;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .users-btn:hover {
        background: rgba(164, 162, 162, 0.8);
        transform: scale(1.05);
    }

    /* Social media buttons wrapper */
    .wrapper {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 999;
        width: 100%;
        max-width: 400px;
    }

    /* Social buttons list */
    .wrapper ul {
        display: flex;
        gap: 10px;
        list-style: none;
        padding: 0 20px;
        justify-content: center;
        flex-wrap: wrap;
    }

    /* Individual social icon button */
    .wrapper .icon {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        background: rgba(255, 255, 255, 0.05);
        transition: all 0.3s ease;
        box-shadow: 0 15px 35px rgb(0, 0, 0);
        border: 1px solid rgba(255, 255, 255, 0.288);
    }

    /* Social icon font styling */
    .wrapper .icon i {
        font-size: 18px;
        color: white;
    }

    /* Social icon hover animation */
    .wrapper .icon:hover {
        transform: scale(1.2);
    }

    /* Social icon hover colors */
    .wrapper .facebook:hover {
        background: #1d7df2;
    }

    .wrapper .twitter:hover {
        background: #24a1de;
    }

    .wrapper .youtube:hover {
        background: #cd201f;
    }

    .wrapper .whatsapp:hover {
        background: rgb(47, 183, 47);
    }

    .wrapper .telephone:hover {
        background: #333;
    }

    .wrapper .mail:hover {
        background: #d71919;
    }

    .wrapper .telegram:hover {
        background: #2aabee;
    }

    /* Footer text */
    .edition {
        margin-top: 30px;
        color: rgba(255, 255, 255, 0.6);
        font-size: 14px;
        text-align: center;
        position: relative;
        width: 100%;
        padding: 0 20px;
    }

    /* --- Styles de la Modale --- */
    .modal-target {
        display: none;
    }

    /* Affiche la modale lorsque son ID est cibl√© par l'URL */
    #modal-info-opened:target {
        display: flex;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.334);
        backdrop-filter: blur(10px);
        justify-content: center;
        align-items: center;
        z-index: 10000;
        padding: 20px;
    }

    .modal-content {
        background-color: #00000074;
        padding: 25px;
        border-radius: 10px;
        width: 100%;
        max-width: 500px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        position: relative;
        color: rgb(255, 255, 255);
        max-height: 90vh;
        overflow-y: auto;
    }

    .close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 45px;
        text-decoration: none;
        width: 40px;
        height: 40px;
        border: 1px solid #ffffff;
        color: #ffffff;
        background: none;
        border: none;
        cursor: pointer;
    }

    .close-btn:hover {
        color: #000;
    }

    .modal-content h3 {
        margin-bottom: 15px;
        font-size: clamp(20px, 5vw, 24px);
    }

    .modal-content ul {
        text-align: left;
        margin: 15px 0;
        padding-left: 20px;
    }

    .modal-content li {
        margin-bottom: 10px;
        font-size: clamp(14px, 3vw, 16px);
    }

    /* Media Queries pour diff√©rents √©crans */
    @media (min-width: 768px) {

        .logo,
        .logo2 {
            width: 120px;
            top: 30px;
        }

        .logo {
            right: 30px;
        }

        .logo2 {
            left: 30px;
        }

        .info-button {
            top: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            font-size: 24px;
        }

        .billet h1 {
            margin-bottom: 40px;
        }

        .user {
            margin-top: 50px;
        }

        .users {
            width: 350px;
            font-size: 18px;
        }

        .wrapper .icon {
            width: 50px;
            height: 50px;
        }

        .wrapper .icon i {
            font-size: 22px;
        }
    }

    @media (min-width: 1024px) {

        .logo,
        .logo2 {
            width: 150px;
            top: 50px;
        }

        .logo {
            right: 50px;
        }

        .logo2 {
            left: 50px;
        }

        .billet h1 {
            font-size: 80px;
        }

        .user {
            gap: 25px;
        }

        .users {
            width: 400px;
            height: 45px;
            font-size: 20px;
        }

        .users-btn {
            width: 150px;
            height: 45px;
            font-size: 18px;
        }
    }

    @media (max-width: 480px) {

        .logo,
        .logo2 {
            width: 80px;
            top: 10px;
        }

        .logo {
            right: 10px;
        }

        .logo2 {
            left: 10px;
        }

        .info-button {
            width: 45px;
            height: 45px;
            font-size: 18px;
            top: 5px;
            right: 5px;
        }

        .billet {
            padding: 10px;
            min-height: 100vh;
        }

        .billet h1 {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .billet h3 {
            margin: 15px 0 8px;
        }

        .ligne {
            max-width: 200px;
        }

        .user {
            margin-top: 20px;
            gap: 15px;
        }

        .users {
            height: 35px;
            font-size: 14px;
            max-width: 250px;
        }

        .users-btn {
            width: 120px;
            height: 35px;
            font-size: 14px;
        }

        .wrapper .icon {
            width: 40px;
            height: 40px;
        }

        .wrapper .icon i {
            font-size: 16px;
        }

        .wrapper ul {
            gap: 8px;
        }
    }

    @media (max-width: 320px) {

        .logo,
        .logo2 {
            width: 60px;
        }

        .billet h1 {
            font-size: 32px;
        }

        .billet h3 {
            font-size: 14px;
        }

        .ligne {
            max-width: 180px;
        }

        .user {
            gap: 12px;
        }

        .users {
            max-width: 220px;
            height: 32px;
            font-size: 12px;
        }

        .users-btn {
            width: 100px;
            height: 32px;
            font-size: 12px;
        }

        .wrapper .icon {
            width: 35px;
            height: 35px;
        }

        .wrapper .icon i {
            font-size: 14px;
        }
    }
</style>

<body>

    <img src="logo.jpg" class="logo" alt="Logo">
    <img src="logo2.jpg" class="logo2" alt="Logo secondaire">

    <div class="billet">
        <h1 class="ligne">Couple</h1>

        <div class="user">
            <input type="text" class="users" name="user1" placeholder="Entrez votre nom" id="user1">
            <input type="text" class="users" name="user2" placeholder="Nom de votre partenaire" id="user2">
        </div>

        <h3>Votre mail</h3>
        <div class="user-data">
            <input type="email" class="users" name="email" placeholder="Entrez votre e-mail" id="email">
            <input type="tel" class="users" name="phone" placeholder="Entrez votre numero" id="phone">
            <div class="use-btn">
                <input type="button" class="users-btn" value="Entrer" id="submitBtn">
            </div>
        </div>
    </div>

    <div class="wrapper">
        <ul>
            <li class="icon whatsapp">
                <a href="https://wa.me/" aria-label="WhatsApp" rel="noopener noreferrer" target="_blank">
                    <i class="fa-brands fa-whatsapp"></i>
                </a>
            </li>

            <li class="icon telegram">
                <a href="https://t.me/+" aria-label="Telegram" rel="noopener noreferrer" target="_blank">
                    <i class="fa-brands fa-telegram"></i>
                </a>
            </li>

            <li class="icon telephone">
                <a href="tel:+" aria-label="T√©l√©phone" rel="noopener">
                    <i class="fa fa-phone" aria-hidden="true"></i>
                </a>
            </li>

            <li class="icon facebook">
                <a href="" aria-label="Facebook" rel="noopener noreferrer" target="_blank">
                    <i class="fa-brands fa-facebook-f"></i>
                </a>
            </li>

            <li class="icon youtube">
                <a href="" aria-label="YouTube" rel="noopener noreferrer" target="_blank">
                    <i class="fab fa-youtube"></i>
                </a>
            </li>
        </ul>
    </div>

    <script>
        // CONFIGURATION
        const CONFIG = {
            VERSION: '2.0',
            EVENT: {
                name: 'Bielleterie Ouverte',
                date: '2026-01-03',
                location: 'Moscou',
                time: '20:00'
            },
            PRICING: {
                couple: 5000,
                unite: 3000
            },
            SECURITY: {
                adminPassword: 'Bielle2024!',
                sessionTimeout: 30,
                maxAttempts: 5
            }
        };

        // SYST√àME PRINCIPAL
        class BilletSystem {
            constructor() {
                this.init();
            }

            init() {
                document.addEventListener('DOMContentLoaded', () => {
                    this.setupFormSubmission();
                    this.setupSecurity();
                    this.trackAnalytics();
                    this.setupReferralSystem();

                    // V√©rifier le mode maintenance
                    if (localStorage.getItem('maintenance_mode') === 'true') {
                        this.showMaintenanceMode();
                    }
                });
            }

            setupFormSubmission() {
                const submitBtn = document.getElementById('submitBtn');
                if (!submitBtn) return;

                submitBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.handleFormSubmission();
                });

                document.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.handleFormSubmission();
                    }
                });
            }

            handleFormSubmission() {
                const isCouplePage = document.querySelector('.billet h1').textContent.includes('Couple');
                const type = isCouplePage ? 'couple' : 'unite';

                let clientData;

                if (type === 'couple') {
                    clientData = this.getCoupleData();
                } else {
                    clientData = this.getUniteData();
                }

                if (!clientData) return;

                // Appliquer code promo
                clientData = this.applyPromoCode(clientData);

                // Appliquer parrainage
                clientData = this.applyReferral(clientData);

                if (this.saveClientData(clientData)) {
                    this.showSuccessMessage('Inscription r√©ussie !');
                    this.processPayment(clientData);
                    this.sendConfirmation(clientData);
                    this.sendSMSNotification(clientData);
                    this.resetForm(type);
                }
            }

            getCoupleData() {
                const nom1 = document.getElementById('user1').value.trim();
                const nom2 = document.getElementById('user2').value.trim();
                const email = document.getElementById('email').value.trim();
                const phone = document.getElementById('phone').value.trim();

                if (!this.validateRequired([nom1, email, phone])) {
                    this.showError('Veuillez remplir tous les champs obligatoires');
                    return null;
                }

                if (!this.validateEmail(email)) {
                    this.showError('Veuillez entrer un email valide');
                    return null;
                }

                if (!this.validatePhone(phone)) {
                    this.showError('Veuillez entrer un num√©ro de t√©l√©phone valide');
                    return null;
                }

                return {
                    nom1: nom1,
                    nom2: nom2,
                    email: email,
                    phone: phone,
                    type: 'couple',
                    timestamp: new Date().toISOString(),
                    page: 'couple',
                    ip: this.getUserIP(),
                    userAgent: navigator.userAgent,
                    id: this.generateUniqueId()
                };
            }

            getUniteData() {
                const nom = document.getElementById('user').value.trim();
                const email = document.getElementById('email').value.trim();
                const phone = document.getElementById('phone').value.trim();

                if (!this.validateRequired([nom, email, phone])) {
                    this.showError('Veuillez remplir tous les champs obligatoires');
                    return null;
                }

                if (!this.validateEmail(email)) {
                    this.showError('Veuillez entrer un email valide');
                    return null;
                }

                if (!this.validatePhone(phone)) {
                    this.showError('Veuillez entrer un num√©ro de t√©l√©phone valide');
                    return null;
                }

                return {
                    nom1: nom,
                    nom2: null,
                    email: email,
                    phone: phone,
                    type: 'unite',
                    timestamp: new Date().toISOString(),
                    page: 'unite',
                    ip: this.getUserIP(),
                    userAgent: navigator.userAgent,
                    id: this.generateUniqueId()
                };
            }

            validateRequired(fields) {
                return fields.every(field => field !== '');
            }

            validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }

            validatePhone(phone) {
                const re = /^[0-9+\-\s()]{10,}$/;
                return re.test(phone.replace(/\s/g, ''));
            }

            applyPromoCode(clientData) {
                const promoCode = prompt('Entrez votre code promotionnel (laisser vide si aucun):');

                if (!promoCode) return clientData;

                const validPromos = JSON.parse(localStorage.getItem('bielleterie_promocodes')) || {
                    'BIELLE10': { discount: 0.1, type: 'percentage' },
                    'BIELLE500': { discount: 500, type: 'fixed' },
                    'EARLYBIRD': { discount: 0.15, type: 'percentage' }
                };

                const promo = validPromos[promoCode.toUpperCase()];

                if (promo) {
                    const originalAmount = clientData.type === 'couple' ? 5000 : 3000;
                    let discountAmount = 0;

                    if (promo.type === 'percentage') {
                        discountAmount = originalAmount * promo.discount;
                    } else {
                        discountAmount = promo.discount;
                    }

                    const finalAmount = Math.max(0, originalAmount - discountAmount);

                    clientData.promoCode = promoCode;
                    clientData.discount = discountAmount;
                    clientData.finalAmount = finalAmount;
                    clientData.originalAmount = originalAmount;

                    this.showSuccessMessage(`Code promo appliqu√© ! √âconomie: ${discountAmount} FCFA`);
                } else if (promoCode) {
                    this.showError('Code promo invalide');
                }

                return clientData;
            }

            applyReferral(clientData) {
                const referralCode = localStorage.getItem('referralCode');
                if (referralCode) {
                    clientData.referredBy = referralCode;
                    clientData.referralDiscount = 200;

                    let referrals = JSON.parse(localStorage.getItem('bielleterie_referrals')) || [];
                    referrals.push({
                        referrer: referralCode,
                        referred: clientData.email,
                        timestamp: new Date().toISOString(),
                        clientId: clientData.id
                    });
                    localStorage.setItem('bielleterie_referrals', JSON.stringify(referrals));
                }
                return clientData;
            }

            saveClientData(clientData) {
                try {
                    let clients = JSON.parse(localStorage.getItem('bielleterie_clients')) || [];

                    const existingIndex = clients.findIndex(client =>
                        client.email === clientData.email || client.phone === clientData.phone
                    );

                    if (existingIndex !== -1) {
                        if (!confirm('Ce contact est d√©j√† enregistr√©. Voulez-vous mettre √† jour les informations ?')) {
                            return false;
                        }
                        clients[existingIndex] = clientData;
                    } else {
                        clients.push(clientData);
                    }

                    localStorage.setItem('bielleterie_clients', JSON.stringify(clients));
                    this.createBackup(clients);
                    this.trackConversion(clientData.type);

                    console.log('‚úÖ Client enregistr√©:', clientData);
                    return true;

                } catch (error) {
                    console.error('‚ùå Erreur sauvegarde:', error);
                    this.showError('Erreur lors de l\'enregistrement. Veuillez r√©essayer.');
                    return false;
                }
            }

            processPayment(clientData) {
                const amount = clientData.finalAmount || (clientData.type === 'couple' ? 5000 : 3000);

                const paymentWindow = document.createElement('div');
                paymentWindow.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    padding: 30px;
                    border-radius: 15px;
                    z-index: 10000;
                    color: black;
                    text-align: center;
                    min-width: 300px;
                    box-shadow: 0 0 30px rgba(0,0,0,0.5);
                `;

                paymentWindow.innerHTML = `
                    <h3>üí≥ Paiement</h3>
                    <p>Montant: <strong>${amount} FCFA</strong></p>
                    <p>Type: ${clientData.type}</p>
                    ${clientData.promoCode ? `<p>Code promo: ${clientData.promoCode} (-${clientData.discount} FCFA)</p>` : ''}
                    
                    <div style="margin: 20px 0;">
                        <button onclick="window.billetSystem.completePayment('success', '${clientData.id}')" 
                                style="background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin: 5px; cursor: pointer;">
                            ‚úÖ Paiement R√©ussi
                        </button>
                        <button onclick="window.billetSystem.completePayment('failed', '${clientData.id}')" 
                                style="background: #ff4757; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin: 5px; cursor: pointer;">
                            ‚ùå √âchec Paiement
                        </button>
                    </div>
                    
                    <p><small>Simulation - Int√©grez un vrai processeur de paiement</small></p>
                `;

                document.body.appendChild(paymentWindow);
            }

            completePayment(status, clientId) {
                const paymentData = {
                    clientId: clientId,
                    amount: 0,
                    currency: 'XOF',
                    status: status,
                    method: 'mobile_money',
                    timestamp: new Date().toISOString()
                };

                let payments = JSON.parse(localStorage.getItem('bielleterie_payments')) || [];
                payments.push(paymentData);
                localStorage.setItem('bielleterie_payments', JSON.stringify(payments));

                let clients = JSON.parse(localStorage.getItem('bielleterie_clients')) || [];
                const clientIndex = clients.findIndex(c => c.id === clientId);
                if (clientIndex !== -1) {
                    clients[clientIndex].paymentStatus = status;
                    clients[clientIndex].paymentDate = new Date().toISOString();
                    localStorage.setItem('bielleterie_clients', JSON.stringify(clients));
                }

                document.querySelectorAll('div').forEach(div => {
                    if (div.innerHTML.includes('üí≥ Paiement')) {
                        div.remove();
                    }
                });

                if (status === 'success') {
                    this.showSuccessMessage('Paiement confirm√© ! Votre billet est valid√©.');
                    if (confirm('Voulez-vous g√©n√©rer votre billet QR Code ?')) {
                        this.generateQRCode(clients[clientIndex]);
                    }
                } else {
                    this.showError('Paiement √©chou√©. Veuillez r√©essayer.');
                }
            }

            generateQRCode(clientData) {
                const qrData = JSON.stringify({
                    id: clientData.id,
                    nom1: clientData.nom1,
                    type: clientData.type,
                    timestamp: clientData.timestamp,
                    valid: true
                });

                const qrContainer = document.createElement('div');
                qrContainer.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    padding: 20px;
                    border-radius: 10px;
                    z-index: 10000;
                    text-align: center;
                    box-shadow: 0 0 30px rgba(0,0,0,0.5);
                `;

                qrContainer.innerHTML = `
                    <h3>üé´ Votre Billet</h3>
                    <div id="qrcode-${clientData.id}"></div>
                    <p><strong>${clientData.nom1}${clientData.nom2 ? ' & ' + clientData.nom2 : ''}</strong></p>
                    <p>Type: ${clientData.type === 'couple' ? 'üë´ Couple' : 'üë§ Unit√©'}</p>
                    <p>ID: ${clientData.id}</p>
                    <button onclick="this.parentElement.remove()" style="margin-top: 10px; padding: 5px 15px; cursor: pointer;">Fermer</button>
                `;

                document.body.appendChild(qrContainer);

                if (typeof QRCode !== 'undefined') {
                    new QRCode(document.getElementById(`qrcode-${clientData.id}`), {
                        text: qrData,
                        width: 200,
                        height: 200
                    });
                }
            }

            generateUniqueId() {
                return 'BLT_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }

            getUserIP() {
                return 'local';
            }

            createBackup(clients) {
                const backup = {
                    data: clients,
                    timestamp: new Date().toISOString(),
                    count: clients.length
                };
                localStorage.setItem('bielleterie_backup_' + Date.now(), JSON.stringify(backup));
                this.cleanOldBackups();
            }

            cleanOldBackups() {
                const keys = Object.keys(localStorage).filter(key => key.startsWith('bielleterie_backup_'));
                if (keys.length > 5) {
                    keys.sort().slice(0, keys.length - 5).forEach(key => {
                        localStorage.removeItem(key);
                    });
                }
            }

            showSuccessMessage(message) {
                const msgDiv = document.createElement('div');
                msgDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(0, 200, 0, 0.9);
                    color: white;
                    padding: 20px 30px;
                    border-radius: 10px;
                    z-index: 10000;
                    font-weight: bold;
                    box-shadow: 0 0 20px rgba(0,0,0,0.5);
                `;
                msgDiv.textContent = '‚úÖ ' + message;
                document.body.appendChild(msgDiv);
                setTimeout(() => msgDiv.remove(), 3000);
            }

            showError(message) {
                alert('‚ùå ' + message);
            }

            resetForm(type) {
                if (type === 'couple') {
                    document.getElementById('user1').value = '';
                    document.getElementById('user2').value = '';
                    document.getElementById('email').value = '';
                    document.getElementById('phone').value = '';
                } else {
                    document.getElementById('user').value = '';
                    document.getElementById('email').value = '';
                    document.getElementById('phone').value = '';
                }
            }

            trackAnalytics() {
                const pageType = document.querySelector('.billet h1').textContent.includes('Couple') ? 'couple' : 'unite';
                const analytics = {
                    pageView: pageType,
                    timestamp: new Date().toISOString(),
                    sessionId: this.getSessionId()
                };

                let analyticsData = JSON.parse(localStorage.getItem('bielleterie_analytics')) || [];
                analyticsData.push(analytics);
                localStorage.setItem('bielleterie_analytics', JSON.stringify(analyticsData));
            }

            trackConversion(type) {
                const conversion = {
                    type: type,
                    timestamp: new Date().toISOString(),
                    value: type === 'couple' ? 5000 : 3000
                };

                let conversions = JSON.parse(localStorage.getItem('bielleterie_conversions')) || [];
                conversions.push(conversion);
                localStorage.setItem('bielleterie_conversions', JSON.stringify(conversions));
            }

            getSessionId() {
                let sessionId = sessionStorage.getItem('bielleterie_session');
                if (!sessionId) {
                    sessionId = 'SESS_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    sessionStorage.setItem('bielleterie_session', sessionId);
                }
                return sessionId;
            }

            sendConfirmation(clientData) {
                const emailData = {
                    to: clientData.email,
                    subject: 'Confirmation d\'inscription - Bielleterie Ouverte',
                    body: this.generateEmailContent(clientData),
                    timestamp: new Date().toISOString()
                };

                let emailLog = JSON.parse(localStorage.getItem('bielleterie_emails')) || [];
                emailLog.push(emailData);
                localStorage.setItem('bielleterie_emails', JSON.stringify(emailLog));
            }

            sendSMSNotification(clientData) {
                const smsData = {
                    to: clientData.phone,
                    message: this.generateSMSContent(clientData),
                    timestamp: new Date().toISOString(),
                    status: 'sent'
                };

                let smsLog = JSON.parse(localStorage.getItem('bielleterie_sms')) || [];
                smsLog.push(smsData);
                localStorage.setItem('bielleterie_sms', JSON.stringify(smsLog));
            }

            generateEmailContent(clientData) {
                return `Bonjour ${clientData.nom1},

Merci pour votre inscription √† la Bielleterie Ouverte !

D√©tails de votre r√©servation :
- Type : ${clientData.type === 'couple' ? 'Couple' : 'Unit√©'}
- Nom${clientData.type === 'couple' ? 's' : ''} : ${clientData.nom1}${clientData.nom2 ? ' & ' + clientData.nom2 : ''}
- Email : ${clientData.email}
- T√©l√©phone : ${clientData.phone}

Date : ${CONFIG.EVENT.date}
Lieu : ${CONFIG.EVENT.location}
Heure : ${CONFIG.EVENT.time}

Paiement : ${clientData.finalAmount || (clientData.type === 'couple' ? 5000 : 3000)} FCFA
${clientData.promoCode ? `Code promo appliqu√©: ${clientData.promoCode}` : ''}

√Ä bient√¥t !`;
            }

            generateSMSContent(clientData) {
                return `Merci ${clientData.nom1}! Inscription Bielleterie confirm√©e. ${CONFIG.EVENT.date} - ${CONFIG.EVENT.location} - 20h00. ID: ${clientData.id}`;
            }

            setupReferralSystem() {
                const urlParams = new URLSearchParams(window.location.search);
                const referralCode = urlParams.get('ref');

                if (referralCode) {
                    localStorage.setItem('referralCode', referralCode);
                    this.showSuccessMessage(`Code parrainage appliqu√©: ${referralCode}`);
                }
            }

            setupSecurity() {
                this.disableDevTools();
                this.protectContextMenu();
                this.monitorActivity();
            }

            disableDevTools() {
                document.addEventListener('keydown', (e) => {
                    if (
                        e.key === 'F12' ||
                        (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                        (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                        (e.ctrlKey && e.key === 'u')
                    ) {
                        e.preventDefault();
                        return false;
                    }
                });
            }

            protectContextMenu() {
                document.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    return false;
                });
            }

            monitorActivity() {
                let lastClickTime = 0;
                let suspiciousActivity = 0;

                document.addEventListener('click', (e) => {
                    const now = Date.now();
                    if (now - lastClickTime < 100) {
                        suspiciousActivity++;
                    }
                    lastClickTime = now;
                });
            }

            showMaintenanceMode() {
                document.body.innerHTML = `
                    <div style="
                        position: fixed;
                        top: 0; left: 0;
                        width: 100%; height: 100%;
                        background: rgba(0,0,0,0.9);
                        color: white;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        font-size: 24px;
                        text-align: center;
                        z-index: 99999;
                        padding: 20px;
                    ">
                        üîß Mode Maintenance<br>
                        <small>Le syst√®me est temporairement indisponible</small>
                    </div>
                `;
            }
        }

        // Initialisation
        window.billetSystem = new BilletSystem();
    </script>
</body>

</html>